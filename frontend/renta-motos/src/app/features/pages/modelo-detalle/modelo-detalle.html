<div class="container mx-auto p-4 space-y-4" *ngIf="ready()">
  <ng-container *ngIf="modelo() as m; else errTpl">

    <!-- Cabecera -->
    <header class="hero">
      <div class="hero__left">
        <h1 class="title">{{ nombreLargo() }}</h1>
        <div class="sub">
          <span class="chip" *ngIf="m.categoria">{{ m.categoria }}</span>
          <!-- Si en el futuro añades 'in_stock' en /modelos/{slug}, puedes mostrar badge de stock aquí -->
        </div>
      </div>

      <div class="hero__right">
        <div class="price"><b>{{ m.precio_base }}€</b> <span>/ día</span></div>
        <div class="deposito" *ngIf="m.deposito_sugerido">Depósito sugerido: {{ m.deposito_sugerido }}€</div>
        <div class="cta">
          <a class="btn-primary" [routerLink]="reservarLink()">Reservar</a>
          <a class="btn outline" [href]="whatsappHref()" target="_blank" rel="noopener">WhatsApp</a>
          <a class="btn outline" href="tel:+34XXXXXXXXX">Llamar</a>
        </div>
      </div>
    </header>

    <!-- Galería -->
    <section class="gallery card">
      <div class="gallery__main" *ngIf="mainImg()">
        <img [src]="mainImg()!" [alt]="nombreLargo()">
      </div>
      <div class="thumbs" *ngIf="gallery().length > 1">
        <button class="thumb" *ngFor="let url of gallery(); let i = index; trackBy: trackUrl"
                [class.active]="i===selIdx()" (click)="selectImg(i)">
          <img [src]="url" [alt]="nombreLargo() + ' ' + (i+1)">
        </button>
      </div>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
      <!-- Especificaciones -->
      <section class="card col-span-2">
        <h2 class="sec-title">Especificaciones</h2>
        <dl class="specs">
          <div *ngFor="let kv of (m.specs | keyvalue)">
            <dt>{{ kv.key | titlecase }}</dt>
            <dd>{{ kv.value }}</dd>
          </div>
          <div *ngIf="m.badges?.length" class="badges">
            <span class="badge" *ngFor="let b of m.badges">{{ b }}</span>
          </div>
        </dl>
      </section>

      <!-- Información útil (texto fijo que puedes cambiar luego) -->
      <aside class="card">
        <h2 class="sec-title">Información</h2>
        <ul class="info">
          <li>Incluye casco(s) básico(s)</li>
          <li>Kilometraje razonable diario</li>
          <li>Seguro a terceros incluido</li>
          <li>Fianza reembolsable</li>
        </ul>
        <p class="hint">* Las condiciones pueden variar según fechas y disponibilidad.</p>
      </aside>
    </div>

    <!-- Descripción larga desde el admin -->
    <section class="card">
      <h2 class="sec-title">Descripción</h2>
      <div class="desc" [innerHTML]="m.descripcion || 'Próximamente…'"></div>
    </section>

  </ng-container>

  <ng-template #errTpl>
    <div class="card">No se pudo cargar el modelo.</div>
  </ng-template>
</div>
